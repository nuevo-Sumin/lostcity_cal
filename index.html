<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Î°úÏä§Ìä∏ÏãúÌã∞ Ï†êÏàò Í≥ÑÏÇ∞Í∏∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, white 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .card-inputs {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .expedition {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .expedition:hover {
            border-color: #007bff;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .expedition h3 {
            color: #495057;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.3em;
        }

        .card-checkboxes {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-bottom: 15px;
        }

        .card-checkbox {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .card-checkbox input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .card-checkbox label {
            font-size: 0.9em;
            font-weight: 600;
            color: #495057;
            text-align: center;
            cursor: pointer;
        }

        .investment-input {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
        }

        .investment-input label {
            font-weight: 600;
            color: #495057;
        }

        .investment-input input {
            width: 5rem;
            padding: 8px 12px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 16px;
            text-align: center;
            transition: border-color 0.3s ease;
        }

        .card-input input:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0,123,255,0.1);
        }

        .calculate-btn {
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2em;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,123,255,0.3);
        }

        .calculate-btn:active {
            transform: translateY(0);
        }

        .button-group {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .clear-btn {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2em;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            font-weight: 600;
        }

        .clear-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(108,117,125,0.3);
        }

        .clear-btn:active {
            transform: translateY(0);
        }

        .results {
            background: #e8f5e8;
            border: 2px solid #28a745;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            display: none;
        }

        .results.show {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .score-breakdown {
            margin-top: 15px;
        }

        .score-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #c3e6c3;
        }

        .score-item:last-child {
            border-bottom: none;
        }

        .total-score {
            font-size: 1.5em;
            font-weight: bold;
            color: #155724;
            text-align: center;
            margin-top: 15px;
            padding: 15px;
            background: #d4edda;
            border-radius: 10px;
        }

        .instructions {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .instructions h3 {
            color: #856404;
            margin-bottom: 15px;
        }

        .instructions ul {
            color: #856404;
            padding-left: 20px;
        }

        .instructions li {
            margin-bottom: 8px;
        }

        .error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            display: none;
        }

        .error.show {
            display: block;
        }

        @media (max-width: 768px) {
            .card-checkboxes {
                grid-template-columns: repeat(3, 1fr);
                gap: 12px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .content {
                padding: 20px;
            }
            
            .expedition {
                padding: 15px;
            }
            
            .card-checkbox label {
                font-size: 0.8em;
            }
        }

        @media (max-width: 480px) {
            .card-checkboxes {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .container {
                margin: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Î°úÏä§Ìä∏ÏãúÌã∞ Lost City</h1>
            <p>Ï†êÏàò Í≥ÑÏÇ∞ Score Calculator</p>
        </div>
        <!--TODO ÌïúÍµ≠Ïñ¥Î≥ÄÌôò -->
        <div class="content">
            <div class="instructions">
                <h3>üìã How to use:</h3>
                <ul>
                    <li>Check the boxes for the card numbers you have in each expedition</li>
                    <li>Enter the number of investment cards (0-3)</li>
                    <li>Get bonus 20 points for 8+ total cards (including investments)</li>
                    <li>Click "Calculate Score" to see your final score</li>
                </ul>
            </div>

            <div class="card-inputs">
                <div class="expedition">
                    <h3>üî¥ Red Expedition</h3>
                    <div class="investment-input">
                        <label>Investment:
                        <input type="number" id="red-investment" min="0" max="3" placeholder="0-3"></label>
                    </div>
                    <div class="card-checkboxes">
                        <div class="card-checkbox">
                            <input type="checkbox" id="red-2" value="2">
                            <label for="red-2">2</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="red-3" value="3">
                            <label for="red-3">3</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="red-4" value="4">
                            <label for="red-4">4</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="red-5" value="5">
                            <label for="red-5">5</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="red-6" value="6">
                            <label for="red-6">6</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="red-7" value="7">
                            <label for="red-7">7</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="red-8" value="8">
                            <label for="red-8">8</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="red-9" value="9">
                            <label for="red-9">9</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="red-10" value="10">
                            <label for="red-10">10</label>
                        </div>
                    </div>
                </div>

                <div class="expedition">
                    <h3>üü° Yellow Expedition</h3>
                    <div class="investment-input">
                        <label>Investment:
                        <input type="number" id="yellow-investment" min="0" max="3" placeholder="0-3"></label>
                    </div>
                    <div class="card-checkboxes">
                        <div class="card-checkbox">
                            <input type="checkbox" id="yellow-2" value="2">
                            <label for="yellow-2">2</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="yellow-3" value="3">
                            <label for="yellow-3">3</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="yellow-4" value="4">
                            <label for="yellow-4">4</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="yellow-5" value="5">
                            <label for="yellow-5">5</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="yellow-6" value="6">
                            <label for="yellow-6">6</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="yellow-7" value="7">
                            <label for="yellow-7">7</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="yellow-8" value="8">
                            <label for="yellow-8">8</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="yellow-9" value="9">
                            <label for="yellow-9">9</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="yellow-10" value="10">
                            <label for="yellow-10">10</label>
                        </div>
                    </div>
                </div>

                <div class="expedition">
                    <h3>üü¢ Green Expedition</h3>
                    <div class="investment-input">
                        <label>Investment:
                            <input type="number" id="green-investment" min="0" max="3" placeholder="0-3"></label>
                    </div>
                    <div class="card-checkboxes">
                        <div class="card-checkbox">
                            <input type="checkbox" id="green-2" value="2">
                            <label for="green-2">2</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="green-3" value="3">
                            <label for="green-3">3</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="green-4" value="4">
                            <label for="green-4">4</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="green-5" value="5">
                            <label for="green-5">5</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="green-6" value="6">
                            <label for="green-6">6</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="green-7" value="7">
                            <label for="green-7">7</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="green-8" value="8">
                            <label for="green-8">8</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="green-9" value="9">
                            <label for="green-9">9</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="green-10" value="10">
                            <label for="green-10">10</label>
                        </div>
                    </div>
                </div>

                <div class="expedition">
                    <h3>üîµ Blue Expedition</h3>
                    <div class="investment-input">
                        <label>Investment:
                            <input type="number" id="blue-investment" min="0" max="3" placeholder="0-3"></label>
                    </div>
                    <div class="card-checkboxes">
                        <div class="card-checkbox">
                            <input type="checkbox" id="blue-2" value="2">
                            <label for="blue-2">2</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="blue-3" value="3">
                            <label for="blue-3">3</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="blue-4" value="4">
                            <label for="blue-4">4</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="blue-5" value="5">
                            <label for="blue-5">5</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="blue-6" value="6">
                            <label for="blue-6">6</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="blue-7" value="7">
                            <label for="blue-7">7</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="blue-8" value="8">
                            <label for="blue-8">8</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="blue-9" value="9">
                            <label for="blue-9">9</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="blue-10" value="10">
                            <label for="blue-10">10</label>
                        </div>
                    </div>
                </div>

                <div class="expedition">
                    <h3>üü£ Purple Expedition</h3>
                    <div class="investment-input">
                        <label>Investment:
                        <input type="number" id="purple-investment" min="0" max="3" placeholder="0-3"></label>
                    </div>
                    <div class="card-checkboxes">
                        <div class="card-checkbox">
                            <input type="checkbox" id="purple-2" value="2">
                            <label for="purple-2">2</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="purple-3" value="3">
                            <label for="purple-3">3</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="purple-4" value="4">
                            <label for="purple-4">4</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="purple-5" value="5">
                            <label for="purple-5">5</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="purple-6" value="6">
                            <label for="purple-6">6</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="purple-7" value="7">
                            <label for="purple-7">7</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="purple-8" value="8">
                            <label for="purple-8">8</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="purple-9" value="9">
                            <label for="purple-9">9</label>
                        </div>
                        <div class="card-checkbox">
                            <input type="checkbox" id="purple-10" value="10">
                            <label for="purple-10">10</label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button class="calculate-btn" onclick="calculateScore()">üéØ Calculate Score</button>
                <button class="clear-btn" onclick="clearAll()">üóëÔ∏è Clear All</button>
            </div>

            <div class="error" id="error-message"></div>

            <div class="results" id="results">
                <h3>üìä Score Breakdown</h3>
                <div class="score-breakdown" id="score-breakdown"></div>
                <div class="total-score" id="total-score"></div>
            </div>
        </div>
    </div>

    <script>
        function calculateScore() {
            // Hide previous results and errors
            document.getElementById('results').classList.remove('show');
            document.getElementById('error-message').classList.remove('show');

            // Get all input values
            const expeditions = [
                { name: 'Red', color: 'red', investment: parseInt(document.getElementById('red-investment').value) || 0 },
                { name: 'Yellow', color: 'yellow', investment: parseInt(document.getElementById('yellow-investment').value) || 0 },
                { name: 'Green', color: 'green', investment: parseInt(document.getElementById('green-investment').value) || 0 },
                { name: 'Blue', color: 'blue', investment: parseInt(document.getElementById('blue-investment').value) || 0 },
                { name: 'Purple', color: 'purple', investment: parseInt(document.getElementById('purple-investment').value) || 0 }
            ];

            // Validate inputs
            for (let exp of expeditions) {
                if (exp.investment < 0 || exp.investment > 3) {
                    showError(`Invalid investment for ${exp.name} expedition. Must be 0-3.`);
                    return;
                }
            }

            // Calculate scores
            let totalScore = 0;
            let breakdown = [];

            for (let exp of expeditions) {
                let expeditionScore = 0;
                let cardCount = 0;
                let cardSum = 0;
                
                // Get checked cards for this expedition
                const checkedCards = [];
                for (let i = 2; i <= 10; i++) {
                    const checkbox = document.getElementById(`${exp.color}-${i}`);
                    if (checkbox && checkbox.checked) {
                        checkedCards.push(i);
                        cardCount++;
                        cardSum += i;
                    }
                }
                
                if (cardCount > 0) {
                    // Calculate expedition score (without bonus yet)
                    expeditionScore = calculateExpeditionScore(cardCount, cardSum);
                    
                    // Add investment multiplier
                    if (exp.investment > 0) {
                        expeditionScore *= (exp.investment + 1);
                    }
                    
                    // Add bonus for 8+ total cards (AFTER investment multiplier)
                    if (cardCount + exp.investment >= 8) {
                        expeditionScore += 20;
                    }
                }

                breakdown.push({
                    name: exp.name,
                    cards: cardCount,
                    cardSum: cardSum,
                    investment: exp.investment,
                    score: expeditionScore
                });

                totalScore += expeditionScore;
            }

            // Display results
            displayResults(breakdown, totalScore);
        }

        function calculateExpeditionScore(cardCount, cardSum) {
            // Lost City scoring: Sum of card values - 20 penalty
            if (cardCount < 2) return 0;
            
            let score = cardSum;
            
            // Penalty: -20 points for each expedition
            score -= 20;
            
            return score;
        }

        function displayResults(breakdown, totalScore) {
            const breakdownDiv = document.getElementById('score-breakdown');
            const totalDiv = document.getElementById('total-score');
            
            let breakdownHTML = '';
            
            for (let exp of breakdown) {
                if (exp.cards > 0) {
                    let bonusText = '';
                    if (exp.cards + exp.investment >= 8) {
                        bonusText = ' + 20 bonus';
                    }
                    
                    breakdownHTML += `
                        <div class="score-item">
                            <span><strong>${exp.name} Expedition:</strong> ${exp.cards} cards (sum: ${exp.cardSum}) - 20 penalty${exp.investment > 0 ? ` √ó ${exp.investment + 1} (investment)` : ''}${bonusText}</span>
                            <span>${exp.score} pts</span>
                        </div>
                    `;
                }
            }

            breakdownDiv.innerHTML = breakdownHTML;
            totalDiv.innerHTML = `üèÜ Total Score: ${totalScore} points`;
            
            document.getElementById('results').classList.add('show');
        }

        function showError(message) {
            const errorDiv = document.getElementById('error-message');
            errorDiv.textContent = message;
            errorDiv.classList.add('show');
        }

        // Add input validation for investment fields
        document.querySelectorAll('input[type="number"]').forEach(input => {
            input.addEventListener('input', function() {
                const value = parseInt(this.value);
                const min = parseInt(this.min);
                const max = parseInt(this.max);
                
                if (this.value !== '' && (value < min || value > max)) {
                    this.style.borderColor = '#dc3545';
                } else {
                    this.style.borderColor = '#dee2e6';
                }
            });
        });

        // Add Enter key support
        document.querySelectorAll('input').forEach(input => {
            input.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    calculateScore();
                }
            });
        });
    </script>
</body>
</html>
